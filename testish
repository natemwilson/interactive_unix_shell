#!/usr/bin/env python

#---------------------------------------------------------------------
# testish
# Author: Bob Dondero
#---------------------------------------------------------------------

#---------------------------------------------------------------------
# testish is a testing script for the ish program.
# To run it, enter the command "testish" for normal output or 
# "testish -b" for brief output.
# The working directory must contain ish and sampleish.
# The script executes the two programs on each file in the working
# directory whose name is of the form commands_* and compares
# the output using diff.
# The lines generated by diff are long, so widen your terminal window.
#---------------------------------------------------------------------

import sys
import os

flags = ''

for arg in sys.argv[1:]:
    if arg.startswith('-'):
        if arg != '-b':
            print >> sys.stderr, 'Usage: ' + sys.argv[0] + ' [-b]'
            sys.exit(1)
        flags = '-b'
    else:
        print >> sys.stderr, 'Usage: ' + sys.argv[0] + ' [-b]'
        sys.exit(1)
        
fileNames = []
for fileName in os.listdir('.'):
    if fileName.startswith('commands_'):
        fileNames += [fileName]

fileNames.sort()

for fileName in fileNames:
    os.system('./testishdiff ' + flags + ' ' + fileName)
